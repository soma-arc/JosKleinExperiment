!function(e){function t(e){delete installedChunks[e]}function n(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.charset="utf-8",n.src=d.p+""+e+"."+_+".hot-update.js",t.appendChild(n)}function i(){return new Promise(function(e,t){if("undefined"==typeof XMLHttpRequest)return t(new Error("No browser support"));try{var n=new XMLHttpRequest,i=d.p+""+_+".hot-update.json";n.open("GET",i,!0),n.timeout=1e4,n.send(null)}catch(e){return t(e)}n.onreadystatechange=function(){if(4===n.readyState)if(0===n.status)t(new Error("Manifest request to "+i+" timed out."));else if(404===n.status)e();else if(200!==n.status&&304!==n.status)t(new Error("Manifest request to "+i+" failed."));else{try{var r=JSON.parse(n.responseText)}catch(e){return void t(e)}e(r)}}})}function r(e){var t=A[e];if(!t)return d;var n=function(n){return t.hot.active?(A[n]?A[n].parents.indexOf(e)<0&&A[n].parents.push(e):(w=[e],v=n),t.children.indexOf(n)<0&&t.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+e),w=[]),d(n)};for(var i in d)Object.prototype.hasOwnProperty.call(d,i)&&"e"!==i&&Object.defineProperty(n,i,function(e){return{configurable:!0,enumerable:!0,get:function(){return d[e]},set:function(t){d[e]=t}}}(i));return n.e=function(e){function t(){x--,"prepare"===O&&(M[e]||l(e),0===x&&0===E&&h())}return"ready"===O&&s("prepare"),x++,d.e(e).then(t,function(e){throw t(),e})},n}function o(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:v!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._acceptedDependencies[e[i]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:u,apply:f,status:function(e){if(!e)return O;I.push(e)},addStatusHandler:function(e){I.push(e)},removeStatusHandler:function(e){var t=I.indexOf(e);t>=0&&I.splice(t,1)},data:k[e]};return v=void 0,t}function s(e){O=e;for(var t=0;t<I.length;t++)I[t].call(null,e)}function a(e){return+e+""===e?+e:e}function u(e){if("idle"!==O)throw new Error("check() is only allowed in idle status");return b=e,s("check"),i().then(function(e){if(!e)return s("idle"),null;L={},M={},T=e.c,g=e.h,s("prepare");var t=new Promise(function(e,t){m={resolve:e,reject:t}});y={};return l(0),"prepare"===O&&0===x&&0===E&&h(),t})}function c(e,t){if(T[e]&&L[e]){L[e]=!1;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(y[n]=t[n]);0==--E&&0===x&&h()}}function l(e){T[e]?(L[e]=!0,E++,n(e)):M[e]=!0}function h(){s("ready");var e=m;if(m=null,e)if(b)f(b).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in y)Object.prototype.hasOwnProperty.call(y,n)&&t.push(a(n));e.resolve(t)}}function f(n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.indexOf(i)<0&&e.push(i)}}if("ready"!==O)throw new Error("apply() is only allowed in ready status");n=n||{};var r,o,u,c,l,h={},f=[],p={},v=function(){console.warn("[HMR] unexpected require("+b.moduleId+") to disposed module")};for(var m in y)if(Object.prototype.hasOwnProperty.call(y,m)){l=a(m);var b;b=y[m]?function(e){for(var t=[e],n={},r=t.slice().map(function(e){return{chain:[e],id:e}});r.length>0;){var o=r.pop(),s=o.id,a=o.chain;if((c=A[s])&&!c.hot._selfAccepted){if(c.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:s};if(c.hot._main)return{type:"unaccepted",chain:a,moduleId:s};for(var u=0;u<c.parents.length;u++){var l=c.parents[u],h=A[l];if(h){if(h.hot._declinedDependencies[s])return{type:"declined",chain:a.concat([l]),moduleId:s,parentId:l};t.indexOf(l)>=0||(h.hot._acceptedDependencies[s]?(n[l]||(n[l]=[]),i(n[l],[s])):(delete n[l],t.push(l),r.push({chain:a.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}(l):{type:"disposed",moduleId:m};var P=!1,I=!1,E=!1,x="";switch(b.chain&&(x="\nUpdate propagation: "+b.chain.join(" -> ")),b.type){case"self-declined":n.onDeclined&&n.onDeclined(b),n.ignoreDeclined||(P=new Error("Aborted because of self decline: "+b.moduleId+x));break;case"declined":n.onDeclined&&n.onDeclined(b),n.ignoreDeclined||(P=new Error("Aborted because of declined dependency: "+b.moduleId+" in "+b.parentId+x));break;case"unaccepted":n.onUnaccepted&&n.onUnaccepted(b),n.ignoreUnaccepted||(P=new Error("Aborted because "+l+" is not accepted"+x));break;case"accepted":n.onAccepted&&n.onAccepted(b),I=!0;break;case"disposed":n.onDisposed&&n.onDisposed(b),E=!0;break;default:throw new Error("Unexception type "+b.type)}if(P)return s("abort"),Promise.reject(P);if(I){p[l]=y[l],i(f,b.outdatedModules);for(l in b.outdatedDependencies)Object.prototype.hasOwnProperty.call(b.outdatedDependencies,l)&&(h[l]||(h[l]=[]),i(h[l],b.outdatedDependencies[l]))}E&&(i(f,[b.moduleId]),p[l]=v)}var M=[];for(o=0;o<f.length;o++)l=f[o],A[l]&&A[l].hot._selfAccepted&&M.push({module:l,errorHandler:A[l].hot._selfAccepted});s("dispose"),Object.keys(T).forEach(function(e){!1===T[e]&&t(e)});for(var L,N=f.slice();N.length>0;)if(l=N.pop(),c=A[l]){var R={},C=c.hot._disposeHandlers;for(u=0;u<C.length;u++)(r=C[u])(R);for(k[l]=R,c.hot.active=!1,delete A[l],u=0;u<c.children.length;u++){var S=A[c.children[u]];S&&((L=S.parents.indexOf(l))>=0&&S.parents.splice(L,1))}}var U,F;for(l in h)if(Object.prototype.hasOwnProperty.call(h,l)&&(c=A[l]))for(F=h[l],u=0;u<F.length;u++)U=F[u],(L=c.children.indexOf(U))>=0&&c.children.splice(L,1);s("apply"),_=g;for(l in p)Object.prototype.hasOwnProperty.call(p,l)&&(e[l]=p[l]);var B=null;for(l in h)if(Object.prototype.hasOwnProperty.call(h,l)){c=A[l],F=h[l];var D=[];for(o=0;o<F.length;o++)U=F[o],r=c.hot._acceptedDependencies[U],D.indexOf(r)>=0||D.push(r);for(o=0;o<D.length;o++){r=D[o];try{r(F)}catch(e){n.onErrored&&n.onErrored({type:"accept-errored",moduleId:l,dependencyId:F[o],error:e}),n.ignoreErrored||B||(B=e)}}}for(o=0;o<M.length;o++){var H=M[o];l=H.module,w=[l];try{d(l)}catch(e){if("function"==typeof H.errorHandler)try{H.errorHandler(e)}catch(t){n.onErrored&&n.onErrored({type:"self-accept-error-handler-errored",moduleId:l,error:t,orginalError:e}),n.ignoreErrored||B||(B=t),B||(B=e)}else n.onErrored&&n.onErrored({type:"self-accept-errored",moduleId:l,error:e}),n.ignoreErrored||B||(B=e)}}return B?(s("fail"),Promise.reject(B)):(s("idle"),new Promise(function(e){e(f)}))}function d(t){if(A[t])return A[t].exports;var n=A[t]={i:t,l:!1,exports:{},hot:o(t),parents:(P=w,w=[],P),children:[]};return e[t].call(n.exports,n,n.exports,r(t)),n.l=!0,n.exports}var p=this.webpackHotUpdate;this.webpackHotUpdate=function(e,t){c(e,t),p&&p(e,t)};var v,m,y,g,b=!0,_="a9e401006b6633c7a468",k={},w=[],P=[],I=[],O="idle",E=0,x=0,M={},L={},T={},A={};d.m=e,d.c=A,d.i=function(e){return e},d.d=function(e,t,n){d.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},d.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return d.d(t,"a",t),t},d.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},d.p="",d.h=function(){return _},r(4)(d.s=4)}([function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=Math.sqrt(2),s=function(){function e(t,n){i(this,e),this.re=t,this.im=n}return r(e,[{key:"add",value:function(t){return new e(this.re+t.re,this.im+t.im)}},{key:"sub",value:function(t){return new e(this.re-t.re,this.im-t.im)}},{key:"mult",value:function(t){return new e(this.re*t.re-this.im*t.im,this.re*t.im+this.im*t.re)}},{key:"div",value:function(t){if(t.isInfinity())return e.ZERO;var n=t.re*t.re+t.im*t.im;return n<1e-7?new e(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY):new e((this.re*t.re+this.im*t.im)/n,(this.im*t.re-this.re*t.im)/n)}},{key:"scale",value:function(t){return new e(this.re*t,this.im*t)}},{key:"arg",value:function(){return Math.atan2(this.im,this.re)}},{key:"conjugate",value:function(){return new e(this.re,-this.im)}},{key:"normalize",value:function(){return this.scale(1/this.abs())}},{key:"abs",value:function(){return Math.sqrt(this.re*this.re+this.im*this.im)}},{key:"absSq",value:function(){return this.re*this.re+this.im*this.im}},{key:"eq",value:function(e){var t=this.re-e.re,n=this.im-e.im;return t*t+n*n<1e-7}},{key:"sq",value:function(){return new e(this.re*this.re-this.im*this.im,this.re*this.im+this.im*this.re)}},{key:"sqrt",value:function(){return this.im>0?new e(Math.sqrt(this.re+Math.sqrt(this.re*this.re+this.im*this.im))/o,Math.sqrt(-this.re+Math.sqrt(this.re*this.re+this.im*this.im))/o):this.i<0?new e(Math.sqrt(this.re+Math.sqrt(this.re*this.re+this.im*this.im))/o,-Math.sqrt(-this.re+Math.sqrt(this.re*this.re+this.im*this.im))/o):this.re<0?new e(0,Math.sqrt(Math.abs(this.re))):new e(Math.sqrt(this.re),0)}},{key:"isInfinity",value:function(){return this.re===Number.POSITIVE_INFINITY||this.im===Number.POSITIVE_INFINITY}},{key:"isZero",value:function(){return Math.abs(this.re)<1e-7&&Math.abs(this.im)<1e-7}},{key:"isReal",value:function(){return Math.abs(this.im)<1e-7}},{key:"isPureImaginary",value:function(){return Math.abs(this.re)<1e-7}},{key:"hasNaN",value:function(){return isNaN(this.re)||isNaN(this.im)}},{key:"linearArray",get:function(){return[this.re,this.im]}}],[{key:"sum",value:function(e,t){return e.add(t)}},{key:"diff",value:function(e,t){return e.sub(t)}},{key:"prod",value:function(e,t){return e.mult(t)}},{key:"quot",value:function(e,t){return e.div(t)}},{key:"conjugate",value:function(e){return e.conjugate()}},{key:"abs",value:function(e){return e.abs()}},{key:"absSq",value:function(e){return e.absSq()}},{key:"eq",value:function(e,t){var n=e.re-t.re,i=e.im-t.im;return n*n+i*i<1e-7}},{key:"distance",value:function(e,t){return e.sub(t).abs()}},{key:"sq",value:function(e){return e.sq()}},{key:"sqrt",value:function(e){return e.sqrt()}},{key:"dot",value:function(e,t){return e.re*t.re+e.im*t.im}},{key:"ZERO",get:function(){return new e(0,0)}},{key:"ONE",get:function(){return new e(1,0)}},{key:"I",get:function(){return new e(0,1)}},{key:"MINUS_ONE",get:function(){return new e(-1,0)}},{key:"INFINITY",get:function(){return new e(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)}}]),e}();t.default=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(3),s=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(s),u=n(6),c=n(5),l=function(){function e(t,n){i(this,e),this.canvasId=t,this.maskit=n,this.canvas=document.getElementById(t),this.pixelRatio=window.devicePixelRatio,this.canvas.style.width=this.canvas.width+"px",this.canvas.style.height=this.canvas.height+"px",this.canvas.width=this.canvas.width*this.pixelRatio,this.canvas.height=this.canvas.height*this.pixelRatio,this.canvasRatio=this.canvas.width/this.canvas.height/2,this.gl=(0,o.GetWebGL2Context)(this.canvas),this.setupShader(),this.setUniformLocations(),this.translate=new a.default(0,1),this.scale=2.1,this.kleinIterations=200,this.sceneScaleFactor=1.5,this.setupMouseListener()}return r(e,[{key:"setupShader",value:function(){this.vertexBuffer=(0,o.CreateSquareVbo)(this.gl),this.renderProgram=this.gl.createProgram(),(0,o.AttachShader)(this.gl,u,this.renderProgram,this.gl.VERTEX_SHADER),(0,o.AttachShader)(this.gl,c,this.renderProgram,this.gl.FRAGMENT_SHADER),(0,o.LinkProgram)(this.gl,this.renderProgram),this.renderVAttrib=this.gl.getAttribLocation(this.renderProgram,"a_vertex"),this.gl.enableVertexAttribArray(this.renderVAttrib)}},{key:"setUniformLocations",value:function(){this.uniLocations=[],this.uniLocations.push(this.gl.getUniformLocation(this.renderProgram,"u_resolution")),this.uniLocations.push(this.gl.getUniformLocation(this.renderProgram,"u_geometry")),this.uniLocations.push(this.gl.getUniformLocation(this.renderProgram,"u_kleinIterations")),this.maskit.setUniformLocations(this.gl,this.uniLocations,this.renderProgram)}},{key:"setUniformValues",value:function(){var e=0;this.gl.uniform2f(this.uniLocations[e++],this.canvas.width,this.canvas.height),this.gl.uniform3f(this.uniLocations[e++],this.translate.re,this.translate.im,this.scale),this.gl.uniform1i(this.uniLocations[e++],this.kleinIterations),e=this.maskit.setUniformValues(this.gl,this.uniLocations,e,this.scale)}},{key:"render",value:function(){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.useProgram(this.renderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.vertexAttribPointer(this.renderCanvasVAttrib,2,this.gl.FLOAT,!1,0,0),this.setUniformValues(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.flush()}},{key:"calcCanvasCoord",value:function(e,t){var n=this.canvas.getBoundingClientRect();return new a.default(this.scale*((e-n.left)*this.pixelRatio/this.canvas.height-this.canvasRatio),this.scale*-((t-n.top)*this.pixelRatio/this.canvas.height-.5))}},{key:"calcSceneCoord",value:function(e,t){return this.calcCanvasCoord(e,t).add(this.translate)}},{key:"setupMouseListener",value:function(){this.mouseState={isPressing:!1,prevPosition:new a.default(0,0),prevTranslate:new a.default(0,0)},this.boundOnMouseWheel=this.onMouseWheel.bind(this),this.canvas.addEventListener("wheel",this.boundOnMouseWheel),this.boundOnMouseDown=this.onMouseDown.bind(this),this.canvas.addEventListener("mousedown",this.boundOnMouseDown),this.boundOnMouseMove=this.onMouseMove.bind(this),this.canvas.addEventListener("mousemove",this.boundOnMouseMove),this.boundOnMouseUp=this.onMouseUp.bind(this),this.canvas.addEventListener("mouseup",this.boundOnMouseUp),this.canvas.addEventListener("contextmenu",function(e){return e.preventDefault()})}},{key:"onMouseWheel",value:function(e){e.preventDefault(),e.deltaY>0?this.scale*=this.sceneScaleFactor:this.scale/=this.sceneScaleFactor,this.render()}},{key:"onMouseDown",value:function(t){t.preventDefault();var n=this.calcSceneCoord(t.clientX,t.clientY);t.button===e.MOUSE_BUTTON_LEFT&&(this.maskit.select(n),this.render()),this.mouseState.prevPosition=n,this.mouseState.prevTranslate=this.translate,this.mouseState.isPressing=!0}},{key:"onMouseUp",value:function(e){this.mouseState.isPressing=!1,this.maskit.release()}},{key:"onMouseMove",value:function(t){if(this.mouseState.isPressing){var n=this.calcSceneCoord(t.clientX,t.clientY);if(t.button===e.MOUSE_BUTTON_LEFT){this.maskit.move(n)&&this.render()}else t.button===e.MOUSE_BUTTON_RIGHT&&(this.translate=this.translate.sub(n.sub(this.mouseState.prevPosition)),this.render())}}}],[{key:"MOUSE_BUTTON_LEFT",get:function(){return 0}},{key:"MOUSE_BUTTON_WHEEL",get:function(){return 1}},{key:"MOUSE_BUTTON_RIGHT",get:function(){return 2}}]),e}();t.default=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(o),a=function(){function e(t,n,r){i(this,e),this.t=new s.default(t,n),this.n=r,this.k=2*Math.cos(Math.PI/this.n),this.update(),this.pointRadius=.03,this.lineWidth=.01,this.selectedComponentId=-1,this.diffToComponent=new s.default(0,0),this.drawLines=!1}return r(e,[{key:"release",value:function(){this.selectedComponentId=-1}},{key:"update",value:function(){this.symmetricalPoint=new s.default(.5*-this.t.im,.5*this.t.re),this.halfK=.5*this.k,this.rightBelowP=new s.default(this.halfK,0),this.leftBelowP=new s.default(-this.halfK,0),this.rightAbobeP=new s.default(this.halfK-this.t.im,this.t.re),this.leftAbobeP=new s.default(-this.halfK-this.t.im,this.t.re);var e=this.rightAbobeP.sub(this.rightBelowP);this.lineRightNormal=new s.default(-e.im,e.re),this.lineLeftNormal=this.lineRightNormal.scale(-1)}},{key:"select",value:function(t){var n=t.sub(this.rightAbobeP);if(n.abs()<this.pointRadius)return this.selectedComponentId=e.POINT_RIGHT_ABOVE,this.diffToComponent=n,!0;var i=t.sub(this.rightBelowP);if(i.abs()<this.pointRadius)return this.selectedComponentId=e.POINT_RIGHT_BELOW,this.diffToComponent=i,!0;var r=t.sub(this.leftAbobeP);if(r.abs()<this.pointRadius)return this.selectedComponentId=e.POINT_LEFT_ABOVE,this.diffToComponent=r,!0;var o=t.sub(this.leftBelowP);if(o.abs()<this.pointRadius)return this.selectedComponentId=e.POINT_LEFT_BELOW,this.diffToComponent=o,!0;var s=t.sub(this.symmetricalPoint);return s.abs()<this.pointRadius&&(this.selectedComponentId=e.POINT_SYMMETRICAL,this.diffToComponent=s,!0)}},{key:"move",value:function(t){switch(this.selectedComponentId){case e.POINT_RIGHT_ABOVE:var n=t.sub(this.diffToComponent);this.t=new s.default(n.im,this.halfK-n.re);break;case e.POINT_RIGHT_BELOW:var i=t.sub(this.diffToComponent);this.k=2*i.re;break;case e.POINT_LEFT_ABOVE:var r=t.sub(this.diffToComponent);this.t=new s.default(r.im,-this.halfK-r.re);break;case e.POINT_LEFT_BELOW:var o=t.sub(this.diffToComponent);this.k=2*o.re;break;case e.POINT_SYMMETRICAL:var a=t.sub(this.diffToComponent);this.t=new s.default(2*a.im,2*-a.re);break;default:return!1}return this.update(),!0}},{key:"setUniformLocations",value:function(e,t,n){t.push(e.getUniformLocation(n,"u_maskit.uv")),t.push(e.getUniformLocation(n,"u_maskit.k")),t.push(e.getUniformLocation(n,"u_maskit.symmetricalPoint")),t.push(e.getUniformLocation(n,"u_maskit.lineLeftNormal")),t.push(e.getUniformLocation(n,"u_maskit.lineLeftPoints")),t.push(e.getUniformLocation(n,"u_maskit.lineRightNormal")),t.push(e.getUniformLocation(n,"u_maskit.lineRightPoints")),t.push(e.getUniformLocation(n,"u_maskit.ui")),t.push(e.getUniformLocation(n,"u_maskit.drawLines"))}},{key:"setUniformValues",value:function(e,t,n,i){var r=n;return e.uniform2f(t[r++],this.t.re,this.t.im),e.uniform1f(t[r++],this.k),e.uniform2f(t[r++],this.symmetricalPoint.re,this.symmetricalPoint.im),e.uniform2f(t[r++],this.lineLeftNormal.re,this.lineLeftNormal.im),e.uniform4f(t[r++],this.leftBelowP.re,this.leftBelowP.im,this.leftAbobeP.re,this.leftAbobeP.im),e.uniform2f(t[r++],this.lineRightNormal.re,this.lineRightNormal.im),e.uniform4f(t[r++],this.rightBelowP.re,this.rightBelowP.im,this.rightAbobeP.re,this.rightAbobeP.im),e.uniform2f(t[r++],this.pointRadius,this.lineWidth),e.uniform1i(t[r++],this.drawLines),r}}],[{key:"POINT_RIGHT_ABOVE",get:function(){return 0}},{key:"POINT_RIGHT_BELOW",get:function(){return 1}},{key:"POINT_LEFT_ABOVE",get:function(){return 2}},{key:"POINT_LEFT_BELOW",get:function(){return 3}},{key:"POINT_SYMMETRICAL",get:function(){}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e){new u;return e.getContext("webgl2")}function r(e,t){var n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),n}function o(e){return r(e,c)}function s(e,t){new u;e.linkProgram(t),e.useProgram(t)}function a(e,t,n,i){var r=(new u,e.createShader(i));e.shaderSource(r,t),e.compileShader(r),e.attachShader(n,r)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured;return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}();t.GetWebGL2Context=i,t.CreateStaticVbo=r,t.CreateSquareVbo=o,t.LinkProgram=s,t.AttachShader=a;var c=[-1,-1,-1,1,1,-1,1,1]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),o=i(r),s=n(1),a=i(s);window.addEventListener("load",function(){var e=new o.default(2,0,.5),t=new a.default("canvas",e),n=document.getElementById("drawLineCheck");n.addEventListener("change",function(){e.drawLines=n.checked,t.render()}),t.render()})},function(e,t){e.exports="#version 300 es\nprecision mediump float;\n\nstruct Maskit {\n    vec2 uv;\n    float k;\n    vec2 symmetricalPoint;\n    vec2 lineLeftNormal;\n    vec4 lineLeftPoints; // [below, above]\n    vec2 lineRightNormal;\n    vec4 lineRightPoints;\n    vec2 ui; // [point radius, line width]\n    bool drawLines;\n};\n\nuniform vec2 u_resolution;\nuniform vec3 u_geometry; // [translateX, translateY, scale]\nuniform int u_kleinIterations;\nuniform Maskit u_maskit;\n\nconst vec3 BLACK = vec3(0, 0, 0.01);\nconst vec3 WHITE = vec3(1);\nconst vec3 RED = vec3(0.8, 0, 0);\nconst vec3 GREEN = vec3(0, 0.8, 0);\nconst vec3 BLUE = vec3(0, 0, 0.8);\nconst vec3 YELLOW = vec3(1, 1, 0);\nconst vec3 PINK = vec3(.78, 0, .78);\nconst vec3 LIGHT_BLUE = vec3(0, 1, 1);\n\n// from Syntopia http://blog.hvidtfeldts.net/index.php/2015/01/path-tracing-3d-fractals/\nvec2 rand2n(vec2 co, float sampleIndex) {\n    vec2 seed = co * (sampleIndex + 1.0);\n\tseed+=vec2(-1,1);\n    // implementation based on: lumina.sourceforge.net/Tutorials/Noise.html\n    return vec2(fract(sin(dot(seed.xy ,vec2(12.9898,78.233))) * 43758.5453),\n                fract(cos(dot(seed.xy ,vec2(4.898,7.23))) * 23421.631));\n}\n\nconst float GAMMA_COEFF = 2.2;\nconst float DISPLAY_GAMMA_COEFF = 1. / GAMMA_COEFF;\nvec3 gammaCorrect(vec3 rgb) {\n  return vec3((min(pow(rgb.r, DISPLAY_GAMMA_COEFF), 1.)),\n              (min(pow(rgb.g, DISPLAY_GAMMA_COEFF), 1.)),\n              (min(pow(rgb.b, DISPLAY_GAMMA_COEFF), 1.)));\n}\n\nvec3 degamma(vec3 rgb) {\n  return vec3((min(pow(rgb.r, GAMMA_COEFF), 1.)),\n              (min(pow(rgb.g, GAMMA_COEFF), 1.)),\n              (min(pow(rgb.b, GAMMA_COEFF), 1.)));\n}\n\nfloat lineY(vec2 pos, vec2 uv){\n\treturn uv.x * .5 + sign(uv.y * .5) * (2.*uv.x-1.95)/4. * sign(pos.x + uv.y * 0.5)* (1. - exp(-(7.2-(1.95-uv.x)*15.)* abs(pos.x + uv.y * 0.5)));\n}\n\nvec2 TransA(vec2 z, vec2 uv){\n\tfloat iR = 1. / dot(z, z);\n\tz *= -iR;\n\tz.x = -uv.y - z.x; z.y = uv.x + z.y;\n    return z;\n}\n\nvec2 TransAInv(vec2 z, vec2 uv){\n\tfloat iR = 1. / dot(z + vec2(uv.y,-uv.x), z + vec2(uv.y, -uv.x));\n\tz.x += uv.y; z.y = uv.x - z.y;\n\tz *= iR;\n    return z;\n}\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvec3 computeColor(float n){\n\treturn hsv2rgb(vec3(.3 +0.06 * n, 1., .7));\n}\n\nconst int LOOP_NUM = 150;\nvec3 josKleinian(vec2 pos, vec2 uv, float translation){\n    float loopNum = 0.;\n    if(pos.y <= 0. || uv.x < pos.y) {\n    \treturn computeColor(loopNum);\n    }\n    vec2 lz = pos + vec2(1.);\n    vec2 llz = pos + vec2(-1.);\n\n    for(int i = 0 ; i < LOOP_NUM ; i++){\n        // translate\n    \tpos.x += translation/2. + (uv.y * pos.y) / uv.x;\n        pos.x = mod(pos.x, translation);\n        pos.x -= translation/2. + (uv.y * pos.y) / uv.x;\n\n        // rotate 180\n        if (pos.y >= lineY(pos, uv.xy)){\n            // pos -= vec2(-uv.y, uv.x) * .5;\n            // pos = - pos;\n            // pos += vec2(-uv.y, uv.x) * .5;\n            // |\n            pos = vec2(-uv.y, uv.x) - pos;\n            //loopNum++;\n        }\n\n        pos = TransA(pos, uv);\n\n        loopNum++;\n\n        // 2-cycle\n        if(dot(pos-llz,pos-llz) < 1e-6) return BLACK;\n\n        if(pos.y <= 0. || uv.x < pos.y) {\n        \treturn computeColor(loopNum);\n        }\n        llz=lz; lz=pos;\n    }\n    return BLACK;\n}\n\nbool renderUI(vec2 pos, out vec3 col){\n    col = BLACK;\n\n    if (distance(pos, u_maskit.symmetricalPoint) < u_maskit.ui.x) {\n        col = PINK;\n        return true;\n    } else if (distance(pos, u_maskit.lineLeftPoints.xy) < u_maskit.ui.x) {\n        col = PINK;\n        return true;\n    } else if (distance(pos, u_maskit.lineLeftPoints.zw) < u_maskit.ui.x) {\n        col = PINK;\n        return true;\n    } else if (distance(pos, u_maskit.lineRightPoints.xy) < u_maskit.ui.x) {\n        col = PINK;\n        return true;\n    } else if (distance(pos, u_maskit.lineRightPoints.zw) < u_maskit.ui.x) {\n        col = PINK;\n        return true;\n    }\n\n    if(u_maskit.drawLines) {\n        // draw line3\n        if(abs(pos.y - lineY(pos, u_maskit.uv)) < u_maskit.ui.y) {\n            col = WHITE;\n            return true;\n        }\n\n        // draw left line\n        float ldot = dot(u_maskit.lineLeftPoints.xy - pos, u_maskit.lineLeftNormal);\n        if(abs(ldot) < u_maskit.ui.y) {\n            col = WHITE;\n            return true;\n        }\n\n        // draw right line\n        ldot = dot(u_maskit.lineRightPoints.xy - pos, u_maskit.lineRightNormal);\n        if(abs(ldot) < u_maskit.ui.y) {\n            col = WHITE;\n            return true;\n        }\n    }\n    return false;\n}\n\nfloat SAMPLE_NUM = 10.;\nout vec4 outColor;\nvoid main() {\n    vec3 sum = vec3(0);\n\tfloat ratio = u_resolution.x / u_resolution.y / 2.0;\n\n    for(float i = 0. ; i < SAMPLE_NUM ; i++){\n        vec2 position = ( (gl_FragCoord.xy + (rand2n(gl_FragCoord.xy, i))) / u_resolution.yy ) - vec2(ratio, 0.5);\n        position *= u_geometry.z;\n        position += u_geometry.xy;\n\n        vec3 c = BLACK;\n        bool render = renderUI(position, c);\n        if(render) {\n            sum += c;\n            continue;\n        }\n\n        sum += josKleinian(position, u_maskit.uv, u_maskit.k);\n    }\n    outColor = vec4(gammaCorrect(sum/SAMPLE_NUM), 1.);\n}\n"},function(e,t){e.exports="#version 300 es\n\nin vec2 a_vertex;\nout vec2 v_texCoord;\n\nvoid main() {\n    v_texCoord = a_vertex.xy * 0.5 + 0.5;\n    gl_Position = vec4(a_vertex, 0., 1.0);\n}\n"}]);